<?xml version="1.0" encoding="UTF-8"?>

<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
  xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd
    http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">

  <changeSet author="kimesawa" id="009">
    <createProcedure>
    -- Function: backs.delete_insert_contact_comment_summary()

    -- DROP FUNCTION backs.delete_insert_contact_comment_summary();

    CREATE OR REPLACE FUNCTION eventer.insert_authority()
      RETURNS trigger AS
        $BODY$DECLARE
      BEGIN
        INSERT INTO account.authority
        (
          mail_address,
          type,
          create_date,
          update_date
        )
        VALUES
        (
          NEW.mail_address,
          'ROLE_EVENTER',
          CURRENT_TIMESTAMP,
          CURRENT_TIMESTAMP
        );
      RETURN NULL; END;$BODY$
      LANGUAGE plpgsql VOLATILE
      COST 100;
      ALTER FUNCTION eventer.insert_authority() OWNER TO basicsample;
    </createProcedure>
  </changeSet>
</databaseChangeLog>